---
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';
import { SITE_TITLE, SITE_DESCRIPTION, SOCIAL_LINKS } from '../consts';
import FormattedDate from '../components/FormattedDate.astro';
import ReadingTime from '../components/ReadingTime.astro';

const latestPosts = (await getCollection('posts'))
	.filter((post) => post.data.lang === 'en' && !post.data.draft)
	.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
	.slice(0, 4);
---

<BaseLayout title={SITE_TITLE} description={SITE_DESCRIPTION}>
	<div class="bg-white dark:bg-gray-900">
		<section class="py-20 sm:py-28">
			<div class="mx-auto flex max-w-6xl flex-col gap-12 px-6 lg:flex-row lg:items-center lg:gap-24 lg:px-8">
				<div class="flex-1">
					<p class="text-sm font-semibold uppercase tracking-widest text-gamboge-600 dark:text-gamboge-400">
						Software · Open Data · Civic Tech
					</p>
					<h1 class="mt-6 text-4xl font-bold tracking-tight text-gray-900 dark:text-white sm:text-6xl">
						Hector Yeomans
					</h1>
					<p class="mt-6 text-lg leading-8 text-gray-600 dark:text-gray-300">
						{SITE_DESCRIPTION}
					</p>
					<div class="mt-10 flex flex-wrap items-center gap-4">
						<a
							href="/posts/"
							class="rounded-full bg-gamboge-600 px-6 py-3 text-sm font-semibold text-white shadow-lg shadow-gamboge-600/30 transition hover:-translate-y-0.5 hover:bg-gamboge-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-gamboge-600"
						>
							Explore Posts
						</a>
						<a
							href="/about/"
							class="text-sm font-semibold text-gray-900 underline-offset-8 hover:text-gamboge-600 dark:text-gray-100 dark:hover:text-gamboge-400"
						>
							About me <span aria-hidden="true">→</span>
						</a>
					</div>
					<div class="mt-10 flex items-center gap-6 text-gray-500 dark:text-gray-400">
						<span class="text-xs uppercase tracking-widest">Connect</span>
						<div class="flex items-center gap-4">
							<a href={SOCIAL_LINKS.github} class="hover:text-gamboge-600 dark:hover:text-gamboge-400" target="_blank" rel="noopener noreferrer">GitHub</a>
							<a href={SOCIAL_LINKS.twitter} class="hover:text-gamboge-600 dark:hover:text-gamboge-400" target="_blank" rel="noopener noreferrer">Twitter</a>
							<a href={SOCIAL_LINKS.linkedin} class="hover:text-gamboge-600 dark:hover:text-gamboge-400" target="_blank" rel="noopener noreferrer">LinkedIn</a>
						</div>
					</div>
				</div>
				<div class="flex-1 rounded-3xl border border-gray-100 bg-white/50 p-6 shadow-xl ring-1 ring-gray-200/60 dark:border-gray-800 dark:bg-gray-900/60 dark:ring-gray-800/50">
					<h2 class="text-sm font-semibold uppercase tracking-[0.3em] text-gray-500 dark:text-gray-400">
						Focus Areas
					</h2>
					<ul class="mt-6 space-y-4 text-base text-gray-700 dark:text-gray-200">
						<li class="flex items-start gap-3">
							<span class="mt-1 h-2.5 w-2.5 rounded-full bg-gamboge-500"></span>
							Crafting resilient services with Go, TypeScript, and distributed architectures.
						</li>
						<li class="flex items-start gap-3">
							<span class="mt-1 h-2.5 w-2.5 rounded-full bg-gamboge-500"></span>
							Investigating transparency and open-data initiatives across Mexico.
						</li>
						<li class="flex items-start gap-3">
							<span class="mt-1 h-2.5 w-2.5 rounded-full bg-gamboge-500"></span>
							Transforming monoliths into maintainable microservices with pragmatic patterns.
						</li>
					</ul>
				</div>
			</div>
		</section>

		<section class="border-t border-gray-100 bg-gray-50 dark:border-gray-800 dark:bg-gray-950/30">
			<div class="mx-auto max-w-6xl px-6 py-16 sm:py-24 lg:px-8">
				<div class="flex items-center justify-between">
					<div>
						<p class="text-sm font-semibold uppercase tracking-[0.3em] text-gray-500 dark:text-gray-400">
							Latest Writing
						</p>
						<h2 class="mt-3 text-3xl font-bold tracking-tight text-gray-900 dark:text-white">
							Fresh insights on software and transparency
						</h2>
					</div>
					<a
						href="/posts/"
						class="text-sm font-semibold text-gamboge-600 hover:text-gamboge-500 dark:text-gamboge-400"
					>
						View all posts →
					</a>
				</div>

				<div class="mt-10 grid gap-8 sm:grid-cols-2">
					{latestPosts.map((post) => {
						const postUrl = `/posts/${post.slug}/`;
						return (
							<article class="group relative rounded-2xl border border-gray-100 bg-white/80 p-6 shadow-sm ring-1 ring-gray-100 transition hover:-translate-y-1 hover:shadow-lg dark:border-gray-800 dark:bg-gray-900/50 dark:ring-gray-800">
								<div class="flex items-center gap-3 text-xs text-gray-500 dark:text-gray-400">
									<FormattedDate date={post.data.pubDate} lang="en" format="short" />
									<span aria-hidden="true">•</span>
									<ReadingTime content={post.body} lang="en" />
								</div>
								<h3 class="mt-4 text-2xl font-semibold text-gray-900 transition group-hover:text-gamboge-600 dark:text-white dark:group-hover:text-gamboge-400">
									<a href={postUrl}>
										<span class="absolute inset-0" aria-hidden="true"></span>
										{post.data.title}
									</a>
								</h3>
								<p class="mt-3 text-base leading-7 text-gray-600 dark:text-gray-300">
									{post.data.description}
								</p>
								<div class="mt-6 flex flex-wrap gap-2">
									{post.data.tags?.slice(0, 3).map((tag) => (
										<span class="inline-flex items-center rounded-full bg-gamboge-100 px-3 py-1 text-xs font-medium text-gamboge-800 dark:bg-gamboge-900 dark:text-gamboge-200">
											#{tag}
										</span>
									))}
								</div>
							</article>
						);
					})}
				</div>
			</div>
		</section>
	</div>
</BaseLayout>
